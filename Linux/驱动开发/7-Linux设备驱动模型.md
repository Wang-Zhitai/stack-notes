# Linux设备驱动模型

## 1. 概览

* Linux 2.6 引入了新的设备管理机制 - kobject
* Linux设备驱动模型分为了几个重要概念：Bus、Class、Device、Driver，所有的设备都要挂在Bus上面，没有单独存在的设备



### 1.1 Bus、Class、Device、Driver

![image-20251125170411862](./assets/image-20251125170411862.png)

* **Bus：**Linux认为总线是CPU和外部设备通信的通道，为了便于设备模型的抽象，所有的设备都应该链接到总线上面（无论是CPU内部总线、真实存在的总线、虚拟的总线、Platform Bus）
* **Class：**类似于面向对象编程语言的`类`的概念，指的是具有相似属性或者功能的设备，这一类设备可以共用一些数据结构和接口函数
* **Device：**抽象出来的硬件设备，描述他的名字、属性、从属的Bus、从属的Class等信息
* **Drive：**抽象出来的设备的驱动程序，包含了设备初始化、电源管理等相关的接口实现，做内核驱动开发基本上都和他相关。



### 1.2 Platform Bus

在计算机中有的片上设备通过他自己的设备控制器直接和CPU相连接，CPU可以直接通过常规的寻址操作访问到这些设备。这些设备的连接方式不属于传统的物理总线相连接，但是为了设备驱动模型的标准化，就引入了这一条虚拟总线，通过标准化的方式描述和连接这些设备，供给这些设备挂靠



## 2. kobject

kobject是实现Bus、Class、Device、Driver的基础